# Q.7) K-Means clustering and Elbow method 
import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt

df = pd.read_csv("7 sales_data_sample.csv",encoding='latin1')
x = df.select_dtypes(include='number').dropna()     
xs = StandardScaler().fit_transform(x)

inertias = []
for k in range(1,11):
    inertias.append(KMeans(n_clusters=k).fit(xs).inertia_)

plt.plot(range(1,11), inertias)
plt.xlabel('k')
plt.ylabel('Inertia')
plt.title('Elbow')
plt.show()

k = 4   
km = KMeans(n_clusters=k).fit(xs)
print("Cluster sizes:\n", pd.Series(km.labels_))
print("Centroids:\n", km.cluster_centers_)
